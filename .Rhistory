library(distill)
create_post("Turorial de Git y GitHub")
library(distill)
create_post("Datasets")
library(distill)
create_post("Datos agrupados con actuar")
knitr::opts_chunk$set(echo = FALSE)
#install.packages("actuar")
library(actuar)
knitr::opts_chunk$set(echo = FALSE,message = FALSE,warning = FALSE)
#install.packages("actuar")
library(actuar)
knitr::include_graphics('frecuencia_agrup.PNG')
knitr::include_graphics('frecuencia_agrup.PNG')
knitr::include_graphics('frecuencia_agrup.PNG')
knitr::opts_chunk$set(echo = FALSE,message = FALSE,warning = FALSE,fig.align='center')
knitr::include_graphics('frecuencia_agrup.PNG')
c(0:4,'5 o más')
knitr::include_graphics('frecuencia_agrup.PNG')
data.frame(Number_accidents=c(0:4,'5 o más'),Number_drivers=c(81714,11306,1618,250,40,7))
kable(data.frame(Number_accidents=c(0:4,'5 o más'),Number_drivers=c(81714,11306,1618,250,40,7)))
library(knitr)
kable(data.frame(Number_accidents=c(0:4,'5 o más'),Number_drivers=c(81714,11306,1618,250,40,7)))
knitr::opts_chunk$set(echo = FALSE,message = FALSE,warning = FALSE,fig.align='center')
library(knitr)
kable(data.frame(Number_accidents=c(0:4,'5 o más'),Number_drivers=c(81714,11306,1618,250,40,7)))
#knitr::include_graphics('frecuencia_agrup.PNG')
library(knitr)
kable(data.frame(Number_accidents=c(0:4,'5 o más'),Number_drivers=c(81714,11306,1618,250,40,7)),caption = 'Ejemplo de datos agrupados para la frecuencia de siniestros.')
#knitr::include_graphics('frecuencia_agrup.PNG')
library(knitr)
kable(data.frame(Number_accidents=c(0:4,'5 o más'),Number_drivers=c(81714,11306,1618,250,40,7)),caption = 'Ejemplo de datos agrupados para la frecuencia de siniestros.')
#knitr::include_graphics('frecuencia_agrup.PNG')
knitr::opts_chunk$set(echo = FALSE,message = FALSE,warning = FALSE,fig.align='center')
options(knitr.table.format = "latex")
knitr::opts_chunk$set(echo = FALSE,message = FALSE,warning = FALSE,fig.align='center')
options(knitr.table.format = "html")
library(knitr)
kable(data.frame(Number_accidents=c(0:4,'5 o más'),Number_drivers=c(81714,11306,1618,250,40,7)),caption = 'Ejemplo de datos agrupados para la frecuencia de siniestros.',label=NA)
#knitr::include_graphics('frecuencia_agrup.PNG')
library(knitr)
kable(data.frame(Number_accidents=c(0:4,'5 o más'),Number_drivers=c(81714,11306,1618,250,40,7)),caption = 'Ejemplo de datos agrupados para la frecuencia de siniestros.',label=NA)
#knitr::include_graphics('frecuencia_agrup.PNG')
sum(c(81714,11306,1618,250,40,7))
knitr::opts_chunk$set(echo = FALSE,message = FALSE,warning = FALSE,fig.align='center')
#kable(data.frame(Number_accidents=c(0:4,'5 o #más'),Number_drivers=c(81714,11306,1618,250,40,7)),caption = 'Ejemplo de datos agrupados #para la severidad.',label="Tabla 2.")
knitr::include_graphics('severidad_agrup.PNG')
#kable(data.frame(Number_accidents=c(0:4,'5 o #más'),Number_drivers=c(81714,11306,1618,250,40,7)),caption = 'Ejemplo de datos agrupados #para la severidad.',label="Tabla 2.")
knitr::include_graphics('severidad_agrup.PNG')
kable(data.frame(Payment_range=c("0-7,500","7,500-17,500","17,500-32,500","32,500-67,500","67,500-125,000","125,000-300,000","Over 300,000"),Number_payments=c(99,42,29,28,17,9,3)),caption = 'Ejemplo de datos agrupados para la severidad.',label="Tabla 2.",align = 'c')
#include_graphics('severidad_agrup.PNG')
library(knitr)
kable(data.frame(Number_accidents=c(0:4,'5 o más'),Number_drivers=c(81714,11306,1618,250,40,7)),caption = 'Ejemplo de datos agrupados para la frecuencia de siniestros.',label="Tabla 1.",align = 'c')
#knitr::include_graphics('frecuencia_agrup.PNG')
gd <- grouped.data(Grupo=c(0,25,100,150,250,500),Frecuencia_1=runif(5,0,300),Frecuencia_2=runif(5,0,300))
gd
?grouped.data
gd <- grouped.data(Grupo=c(0,25,100,150,250,500),Frecuencia_1=runif(6,0,300),Frecuencia_2=runif(6,0,300))
runif(6,0,300)
gd <- grouped.data(Grupo=c(0,25,100,150,250,500),Frecuencia_1=c(30, 31, 57, 42, 45, 10),Frecuencia_2=c(81,40,33,12,7,26))
c(0,25,100,150,250,500)
gd <- grouped.data(Grupo=c(0,25,50,100,150,250,500),Frecuencia_1=c(30, 31, 57, 42, 45, 10),Frecuencia_2=c(81,40,33,12,7,26))
gd
gd
gd <- grouped.data(Grupo=c(0,25,50,100,150,250,500),Frecuencia_1=c(30, 31, 57, 42, 45, 10),Frecuencia_2=c(81,40,33,12,7,26))
gd
gd <- grouped.data(Grupo=c(0,25,50,100,150,250,500),Frecuencia_1=c(30, 31, 57, 42, 45,10), Frecuencia_2=c(81,40,33,12,7,26))
gd
gd <- grouped.data(Grupo=c(0,25,50,100,150,250,500),Frecuencia_1=c(30, 31, 57, 42, 45,10), Frecuencia_2=c(81,40,33,12,7,26))
(gd <- grouped.data(Grupo=c(0,25,50,100,150,250,500),Frecuencia_1=c(30, 31, 57, 42, 45,10), Frecuencia_2=c(81,40,33,12,7,26)))
gd
gd <- grouped.data(Grupo=c(0,25,50,100,150,250,500),Frecuencia_1=c(30, 31, 57, 42, 45,10), Frecuencia_2=c(81,40,33,12,7,26))
gd
print(gp)
print(gd)
gd <- grouped.data(Grupo=c(0,25,50,100,150,250,500),Frecuencia_1=c(30, 31, 57, 42, 45,10), Frecuencia_2=c(81,40,33,12,7,26))
View(gd)
str(gd)
gd
gd
type(gd$Grupo)
class(gd$Grupo)
gd[,1]
class(gd[,1])
#Columna tipo character
class(gd$Grupo)
#Vector numérico
gd[,1]
class(gd[,1])
#Columna tipo character
gd$Grupo
knitr::opts_chunk$set(echo = FALSE,message = FALSE,warning = FALSE,fig.align='center')
library(ggplot2)
library(knitr)
kable(data.frame(Number_accidents=c(0:4,'5 o más'),Number_drivers=c(81714,11306,1618,250,40,7)),caption = 'Ejemplo de datos agrupados para la frecuencia de siniestros.',label="Tabla 1.",align = 'c')
#knitr::include_graphics('frecuencia_agrup.PNG')
kable(data.frame(Payment_range=c("0-7,500","7,500-17,500","17,500-32,500","32,500-67,500","67,500-125,000","125,000-300,000","Over 300,000"),Number_payments=c(99,42,29,28,17,9,3)),caption = 'Ejemplo de datos agrupados para la severidad.',label="Tabla 2.",align = 'c')
#include_graphics('severidad_agrup.PNG')
#install.packages("actuar")
library(actuar)
gd <- grouped.data(Grupo=c(0,25,50,100,150,250,500),
Frecuencia_1=c(30, 31, 57, 42, 45,10),
Frecuencia_2=c(81,40,33,12,7,26))
gd
#Columna tipo character
gd$Grupo
class(gd$Grupo)
#Vector numérico
gd[,1]
class(gd[,1])
#Histograma de Frecuencia_1
hist(gd[,-3],col="lightblue",main="Frecuencia_1",xlab="Grupos")
#Histograma de Frecuencia_2
hist(gd[,-2],col="lightpink",main="Frecuencia_2",xlab="Grupos")
#Creamos Fn (una función)
Fn <- ogive(gd)
#Para obtener los extremos de los intervalos
knots(Fn)
#Valores de la ojiva en dichos extremos
Fn(knots(Fn))
#Gráfica de la función
plot(Fn)
ggplot(data.frame(x=knots(Fn),y=Fn(knots(Fn))),aes(x=x,y=y)) +
geom_line(col='skyblue2',size=1.2) + geom_point(col='slateblue',size=1.5) +
ylab("Fn(x)") +
ggtitle("ogive")+
theme_minimal() +
theme(plot.title = element_text(size=15, face="bold",
margin = margin(10, 0, 10, 0),family = "mono"))
#Para obtener los extremos de los intervalos
knots(Fn)
Fn(20)
#Valores de la ojiva en dichos extremos
Fn(knots(Fn))
mean(gd)
#Cálculo de los primeros tres momentos empíricos
emm(gd,order=1:3)
lev <- elev(gd)
knots(lev)
knots(lev)
#Valor de la función en los extremos de los intervalos
lev(knots(lev))
#Gráfica de la función
plot(lev)
#Gráfica de la función
plot(lev,type="o")
#Gráfica de la función
plot(lev,type="o",pch=19)
?emm
#Cálculo de los primeros tres momentos empíricos
emm(gd,order=1:3)
#mean
gd[1,]
#mean
gd[,1]
#mean
c<-gd[,1]
n <- gd[,2]
c_d <- diff(c)
c_d
((c+c_d)/2)*n
#mean
c<-gd[,1]
c
c_d
n
25*25
25*15
((c+c_d)/2)*n
c_d <- diff(c)
c_d
c
c_d <- lag(c)
c_d
c_d <- lag(c,1)
c_d
c_d <- c[-1]
c_d
c
c[-7]
n
((c[-7]+c_d)/2)*n
sum(((c[-7]+c_d)/2)*n)
#Cálculo de los primeros tres momentos empíricos
emm(gd,order=1:3)
c[-7]+c_d
n
25*15
((c[-7]+c_d)/2)*n
75*31/2
75*57
sum(n)
sum(((c[-7]+c_d)/2)*n)
sum(((c[-7]+c_d)/2)*n)/215
#Cálculo de los primeros tres momentos empíricos
emm(gd,order=1:3)
c^3
(c-c_d)
(c_d-c)
c
c_d
sum(((c_d^3-c^3)/(4*215*(c_d-c)))*n)
sum(((c_d^3-c^3)/(4*215*(c_d-c)))*n)/215
#Cálculo de los primeros tres momentos empíricos
emm(gd,order=1:3)
sum(((c_d^3-c^3)/(4*215*(c_d-c)))*n)/215
sum(((c_d^4-c^4)/(4*215*(c_d-c)))*n)/215
sum(((c_d^4-c^4)/(4*215*(c_d-c)))*n)/215
#Cálculo de los primeros tres momentos empíricos
emm(gd,order=1:3)
sum(((c_d^4-c^4)/(4*215*(c_d-c)))*n)
sum(((c_d^3-c^3)/(4*215*(c_d-c)))*n)
#Cálculo de los primeros tres momentos empíricos
emm(gd,order=1:3)
sum(((c_d^3-c^3)/(4*215*(c_d-c)))*n)
c_d^3-c^3
c
c_d
c <- c[-7]
c
sum(((c_d^3-c^3)/(4*215*(c_d-c)))*n)
sum(((c_d^4-c^4)/(4*215*(c_d-c)))*n)
#Cálculo de los primeros tres momentos empíricos
emm(gd,order=1:3)
sum(((c_d^4-c^4)/(4*215*(c_d-c)))*n)
#Extremos de los intervalos
knots(lev)
#Valor de la función en los extremos de los intervalos
lev(knots(lev))
lev(knots(lev))[3:4]
sum(lev(knots(lev))[3:4])
sum(lev(knots(lev))[3:4])/2
lev(75)
#Extremos de los intervalos
x<- seq(0,500,by=25)
x
#Valor de la función en los extremos de los intervalos
lev(x)
#Gráfica de la función
plot(lev,pch=19)
#Gráfica de la función en los valores de x
plot(x=x,y=lev(x),pch=19)
#Al graficar la función, se grafican de manera determinada sus valores en los extremos de los intervalos
plot(lev,pch=19)
#Extremos de los intervalos
knots(lev)
#Valor de la función en los extremos de los intervalos
lev(knots(lev))
#Gráfica de la función en los valores de d
d<- seq(0,500,by=25)
ggplot(data.frame(x=d,y=lev(d)),aes(x=x,y=y)) +
geom_point(color="green") +
ggtitle("Primer momento empírico limitado con límite d")+
xlab("d") + ylab("lev(d)") +
theme_minimal()
ggplot(data.frame(x=d,y=lev(d)),aes(x=x,y=y)) +
geom_point(color="green") + geom_line(color="lightgreen")+
ggtitle("Primer momento empírico limitado con límite d")+
xlab("d") + ylab("lev(d)") +
theme_minimal()
library(distill)
create_post("Fórmulas recursivas para la densidad de las pérdidas agregadas")
install.packages("xaringanExtra")
remotes::install_github("gadenbuie/xaringanExtra")
library(learnr)
panjer_f <- function(s,a,b,g0,fX){
g <- rep(NA,s+1)
g[1] <- g0
i=1
while(i<=s) {
g[i+1] <- 0
for (j in 1:i) {
g[i+1] <- g[i+1] + (1/(1-a*fX(0)))*(a+b*j/i)* fX(j)*g[i+1-j]
}
i=i+1
}
return(g)
}
b2 <- 2
g02 <- dpois(0,2)
f <- function(x){
if(x>0){
return(0.6*(0.4^(x-1)))
}else{
return(0)
}
}
s <- 20
gs2 <- panjer_f(s,a,b2,g02,f)
gs2[1:10]
a <- 0
b2 <- 2
g02 <- dpois(0,2)
f <- function(x){
if(x>0){
return(0.6*(0.4^(x-1)))
}else{
return(0)
}
}
s <- 20
gs2 <- panjer_f(s,a,b2,g02,f)
gs2[1:10]
